2025-06-20 08:48:49 [main] INFO  com.jervis.JervisApplicationKt - Starting JervisApplicationKt using Java 21.0.7 with PID 89790 (/Users/damekjan/git/jervis/target/classes started by damekjan in /Users/damekjan/git/jervis)
2025-06-20 08:48:49 [main] DEBUG com.jervis.JervisApplicationKt - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-06-20 08:48:49 [main] INFO  com.jervis.JervisApplicationKt - No active profile set, falling back to 1 default profile: "default"
2025-06-20 08:48:49 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-20 08:48:50 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 19 ms. Found 2 JPA repository interfaces.
2025-06-20 08:48:50 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 5500 (http)
2025-06-20 08:48:50 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-20 08:48:50 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-06-20 08:48:50 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-20 08:48:50 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 925 ms
2025-06-20 08:48:50 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-20 08:48:50 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:file:~/.jervis/jervis-db user=SA
2025-06-20 08:48:50 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-20 08:48:50 [main] INFO  liquibase.database - Set default schema name to PUBLIC
2025-06-20 08:48:50 [main] INFO  liquibase.changelog - Reading from PUBLIC.DATABASECHANGELOG
2025-06-20 08:48:51 [main] INFO  liquibase.lockservice - Successfully acquired change log lock
2025-06-20 08:48:51 [main] INFO  liquibase.command - Using deploymentId: 0402131003
2025-06-20 08:48:51 [main] INFO  liquibase.changelog - Reading from PUBLIC.DATABASECHANGELOG
2025-06-20 08:48:51 [main] INFO  liquibase.ui - Running Changeset: db/changelog/changes/003-memory-items-vector-id.yaml::3::jervis
2025-06-20 08:48:51 [main] INFO  liquibase.changelog - Columns vector_id(VARCHAR(100)) added to memory_items
2025-06-20 08:48:51 [main] INFO  liquibase.changelog - ChangeSet db/changelog/changes/003-memory-items-vector-id.yaml::3::jervis ran successfully in 7ms
2025-06-20 08:48:51 [main] INFO  liquibase.util - UPDATE SUMMARY
2025-06-20 08:48:51 [main] INFO  liquibase.util - Run:                          1
2025-06-20 08:48:51 [main] INFO  liquibase.util - Previously run:               2
2025-06-20 08:48:51 [main] INFO  liquibase.util - Filtered out:                 0
2025-06-20 08:48:51 [main] INFO  liquibase.util - -------------------------------
2025-06-20 08:48:51 [main] INFO  liquibase.util - Total change sets:            3
2025-06-20 08:48:51 [main] INFO  liquibase.util - Update summary generated
2025-06-20 08:48:51 [main] INFO  liquibase.command - Update command completed successfully.
2025-06-20 08:48:51 [main] INFO  liquibase.ui - Liquibase: Update has been successful. Rows affected: 1
2025-06-20 08:48:51 [main] INFO  liquibase.lockservice - Successfully released change log lock
2025-06-20 08:48:51 [main] INFO  liquibase.command - Command execution complete
2025-06-20 08:48:51 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-20 08:48:51 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.13.Final
2025-06-20 08:48:51 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-20 08:48:51 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-20 08:48:51 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-20 08:48:51 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.2.224
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-20 08:48:51 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-20 08:48:51 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-20 08:48:52 [main] INFO  c.j.module.vectordb.VectorDbService - Initializing Qdrant client at localhost:6334
2025-06-20 08:48:52 [main] INFO  c.j.module.vectordb.VectorDbService - Collection code_vectors already exists
2025-06-20 08:48:52 [main] INFO  c.j.module.vectordb.VectorDbService - Collection text_vectors already exists
2025-06-20 08:48:52 [main] INFO  c.j.module.vectordb.VectorDbService - Collection unified_vectors already exists
2025-06-20 08:48:52 [main] INFO  c.j.module.vectordb.VectorDbService - Qdrant client initialized successfully
2025-06-20 08:48:52 [main] INFO  c.j.module.indexer.EmbeddingService - Initializing embedding models...
2025-06-20 08:48:52 [main] INFO  c.j.module.indexer.EmbeddingService - Loading code embedding model: intfloat/multilingual-e5-large
2025-06-20 08:48:57 [main] INFO  ai.djl.pytorch.engine.PtEngine - PyTorch graph executor optimizer is enabled, this may impact your inference latency and throughput. See: https://docs.djl.ai/master/docs/development/inference_performance_optimization.html#graph-executor-optimization
2025-06-20 08:48:57 [main] INFO  ai.djl.pytorch.engine.PtEngine - Number of inter-op threads is 8
2025-06-20 08:48:57 [main] INFO  ai.djl.pytorch.engine.PtEngine - Number of intra-op threads is 6
2025-06-20 08:48:59 [main] INFO  ai.djl.util.Platform - Found matching platform from: jar:file:/Users/damekjan/.m2/repository/ai/djl/huggingface/tokenizers/0.33.0/tokenizers-0.33.0.jar!/native/lib/tokenizers.properties
2025-06-20 08:48:59 [main] INFO  c.j.module.indexer.EmbeddingService - Loading text embedding model: intfloat/multilingual-e5-large
2025-06-20 08:49:01 [main] INFO  c.j.module.indexer.EmbeddingService - Embedding models initialized successfully
2025-06-20 08:49:01 [main] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - Initializing HuggingFace tokenizer with model: gpt2
2025-06-20 08:49:01 [main] WARN  a.d.h.t.HuggingFaceTokenizer - maxLength is not explicitly specified, use modelMaxLength: 512
2025-06-20 08:49:01 [main] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - HuggingFace tokenizer initialized successfully
2025-06-20 08:49:01 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-20 08:49:02 [main] INFO  o.s.v.b.OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
2025-06-20 08:49:02 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 5500 (http) with context path '/'
2025-06-20 08:49:02 [main] INFO  com.jervis.JervisApplicationKt - Started JervisApplicationKt in 13.156 seconds (process running for 13.914)
2025-06-20 08:49:03 [main] INFO  com.jervis.utils.MacOSAppUtils - Ikona v docku byla úspěšně nastavena pomocí Taskbar API
2025-06-20 08:49:20 [Thread-2] INFO  com.jervis.service.ChatService - Processing chat query: Ahoj, mame neco v pameti?
2025-06-20 08:49:20 [Thread-2] INFO  com.jervis.service.RagQueryService - Processing RAG query: Ahoj, mame neco v pameti?
2025-06-20 08:49:20 [Thread-2] DEBUG com.jervis.service.RagQueryService - Phase 1: Initial RAG query
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1}
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in unified collection: unified_vectors
2025-06-20 08:49:21 [Thread-2] ERROR c.j.module.vectordb.VectorDbService - Error searching for similar documents: class java.lang.Long cannot be cast to class java.lang.Integer (java.lang.Long and java.lang.Integer are in module java.base of loader 'bootstrap')
java.lang.ClassCastException: class java.lang.Long cannot be cast to class java.lang.Integer (java.lang.Long and java.lang.Integer are in module java.base of loader 'bootstrap')
	at com.jervis.module.vectordb.VectorDbService.searchSimilar(VectorDbService.kt:220)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:34)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1, source=memory, memory_type=DECISION}
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in unified collection: unified_vectors
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Applied filter to search
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Executing search in collection: unified_vectors
2025-06-20 08:49:21 [Thread-2] WARN  c.j.module.vectordb.VectorDbService - Error searching collection unified_vectors: Vector must not be empty
java.lang.IllegalArgumentException: Vector must not be empty
	at com.google.common.base.Preconditions.checkArgument(Preconditions.java:143)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2254)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2240)
	at com.jervis.module.vectordb.VectorDbService.searchSimilar(VectorDbService.kt:317)
	at com.jervis.module.memory.MemoryService.getMemoryItemsByType(MemoryService.kt:57)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.jervis.module.memory.MemoryService$$SpringCGLIB$$0.getMemoryItemsByType(<generated>)
	at com.jervis.module.ragcore.RagContextManager.addMemoryItemsToContext(RagContextManager.kt:92)
	at com.jervis.module.ragcore.RagContextManager.buildContext(RagContextManager.kt:40)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:41)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 total results across all collections
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Returning 0 results after sorting and limiting
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1, source=memory, memory_type=PLAN}
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in unified collection: unified_vectors
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Applied filter to search
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Executing search in collection: unified_vectors
2025-06-20 08:49:21 [Thread-2] WARN  c.j.module.vectordb.VectorDbService - Error searching collection unified_vectors: Vector must not be empty
java.lang.IllegalArgumentException: Vector must not be empty
	at com.google.common.base.Preconditions.checkArgument(Preconditions.java:143)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2254)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2240)
	at com.jervis.module.vectordb.VectorDbService.searchSimilar(VectorDbService.kt:317)
	at com.jervis.module.memory.MemoryService.getMemoryItemsByType(MemoryService.kt:57)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.jervis.module.memory.MemoryService$$SpringCGLIB$$0.getMemoryItemsByType(<generated>)
	at com.jervis.module.ragcore.RagContextManager.addMemoryItemsToContext(RagContextManager.kt:96)
	at com.jervis.module.ragcore.RagContextManager.buildContext(RagContextManager.kt:40)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:41)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 total results across all collections
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Returning 0 results after sorting and limiting
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1, source=memory, memory_type=MEETING_TRANSCRIPT}
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in unified collection: unified_vectors
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Applied filter to search
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Executing search in collection: unified_vectors
2025-06-20 08:49:21 [Thread-2] WARN  c.j.module.vectordb.VectorDbService - Error searching collection unified_vectors: Vector must not be empty
java.lang.IllegalArgumentException: Vector must not be empty
	at com.google.common.base.Preconditions.checkArgument(Preconditions.java:143)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2254)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2240)
	at com.jervis.module.vectordb.VectorDbService.searchSimilar(VectorDbService.kt:317)
	at com.jervis.module.memory.MemoryService.getMemoryItemsByType(MemoryService.kt:57)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.jervis.module.memory.MemoryService$$SpringCGLIB$$0.getMemoryItemsByType(<generated>)
	at com.jervis.module.ragcore.RagContextManager.addMemoryItemsToContext(RagContextManager.kt:101)
	at com.jervis.module.ragcore.RagContextManager.buildContext(RagContextManager.kt:40)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:41)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 total results across all collections
2025-06-20 08:49:21 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Returning 0 results after sorting and limiting
2025-06-20 08:49:22 [Thread-2] ERROR com.jervis.service.ChatService - Error processing chat query: 401 Unauthorized on POST request for "https://api.anthropic.com/v1/messages": [no body]
org.springframework.web.client.HttpClientErrorException$Unauthorized: 401 Unauthorized on POST request for "https://api.anthropic.com/v1/messages": [no body]
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:106)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:186)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147)
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801)
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518)
	at com.jervis.module.llmcoordinator.LlmCoordinator.callAnthropicApi(LlmCoordinator.kt:377)
	at com.jervis.module.llmcoordinator.LlmCoordinator.processAnthropicQuery(LlmCoordinator.kt:263)
	at com.jervis.module.llmcoordinator.LlmCoordinator.processQuery(LlmCoordinator.kt:203)
	at com.jervis.module.llmcoordinator.LlmCoordinator.processQuery$default(LlmCoordinator.kt:166)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:55)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 08:53:51 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-20 08:53:52 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-06-20 08:53:52 [SpringApplicationShutdownHook] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - Closing HuggingFace tokenizer
2025-06-20 08:53:52 [SpringApplicationShutdownHook] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - HuggingFace tokenizer closed successfully
2025-06-20 08:53:52 [SpringApplicationShutdownHook] INFO  c.j.module.indexer.EmbeddingService - Closing embedding models...
2025-06-20 08:53:53 [SpringApplicationShutdownHook] INFO  c.j.module.indexer.EmbeddingService - Embedding models closed successfully
2025-06-20 08:53:53 [SpringApplicationShutdownHook] INFO  c.j.module.vectordb.VectorDbService - Closing Qdrant client
2025-06-20 08:53:53 [SpringApplicationShutdownHook] INFO  c.j.module.vectordb.VectorDbService - Qdrant client closed successfully
2025-06-20 08:53:53 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-20 08:53:53 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-06-20 08:53:53 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-06-20 08:53:58 [main] INFO  com.jervis.JervisApplicationKt - Starting JervisApplicationKt using Java 21.0.7 with PID 90264 (/Users/damekjan/git/jervis/target/classes started by damekjan in /Users/damekjan/git/jervis)
2025-06-20 08:53:58 [main] DEBUG com.jervis.JervisApplicationKt - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-06-20 08:53:58 [main] INFO  com.jervis.JervisApplicationKt - No active profile set, falling back to 1 default profile: "default"
2025-06-20 08:53:58 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-20 08:53:58 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 23 ms. Found 2 JPA repository interfaces.
2025-06-20 08:53:59 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 5500 (http)
2025-06-20 08:53:59 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-20 08:53:59 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-06-20 08:53:59 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-20 08:53:59 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 867 ms
2025-06-20 08:53:59 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-20 08:53:59 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:file:~/.jervis/jervis-db user=SA
2025-06-20 08:53:59 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-20 08:53:59 [main] INFO  liquibase.database - Set default schema name to PUBLIC
2025-06-20 08:53:59 [main] INFO  liquibase.changelog - Reading from PUBLIC.DATABASECHANGELOG
2025-06-20 08:53:59 [main] INFO  liquibase.ui - Database is up to date, no changesets to execute
2025-06-20 08:53:59 [main] INFO  liquibase.changelog - Reading from PUBLIC.DATABASECHANGELOG
2025-06-20 08:53:59 [main] INFO  liquibase.util - UPDATE SUMMARY
2025-06-20 08:53:59 [main] INFO  liquibase.util - Run:                          0
2025-06-20 08:53:59 [main] INFO  liquibase.util - Previously run:               3
2025-06-20 08:53:59 [main] INFO  liquibase.util - Filtered out:                 0
2025-06-20 08:53:59 [main] INFO  liquibase.util - -------------------------------
2025-06-20 08:53:59 [main] INFO  liquibase.util - Total change sets:            3
2025-06-20 08:53:59 [main] INFO  liquibase.util - Update summary generated
2025-06-20 08:53:59 [main] INFO  liquibase.lockservice - Successfully released change log lock
2025-06-20 08:53:59 [main] INFO  liquibase.command - Command execution complete
2025-06-20 08:53:59 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-20 08:53:59 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.13.Final
2025-06-20 08:53:59 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-20 08:54:00 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-20 08:54:00 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-20 08:54:00 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.2.224
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-20 08:54:00 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-20 08:54:00 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-20 08:54:01 [main] INFO  c.j.module.vectordb.VectorDbService - Initializing Qdrant client at localhost:6334
2025-06-20 08:54:01 [main] INFO  c.j.module.vectordb.VectorDbService - Collection code_vectors already exists
2025-06-20 08:54:01 [main] INFO  c.j.module.vectordb.VectorDbService - Collection text_vectors already exists
2025-06-20 08:54:01 [main] INFO  c.j.module.vectordb.VectorDbService - Collection unified_vectors already exists
2025-06-20 08:54:01 [main] INFO  c.j.module.vectordb.VectorDbService - Qdrant client initialized successfully
2025-06-20 08:54:01 [main] INFO  c.j.module.indexer.EmbeddingService - Initializing embedding models...
2025-06-20 08:54:01 [main] INFO  c.j.module.indexer.EmbeddingService - Loading code embedding model: intfloat/multilingual-e5-large
2025-06-20 08:54:02 [main] INFO  ai.djl.pytorch.engine.PtEngine - PyTorch graph executor optimizer is enabled, this may impact your inference latency and throughput. See: https://docs.djl.ai/master/docs/development/inference_performance_optimization.html#graph-executor-optimization
2025-06-20 08:54:02 [main] INFO  ai.djl.pytorch.engine.PtEngine - Number of inter-op threads is 8
2025-06-20 08:54:02 [main] INFO  ai.djl.pytorch.engine.PtEngine - Number of intra-op threads is 6
2025-06-20 08:54:03 [main] INFO  ai.djl.util.Platform - Found matching platform from: jar:file:/Users/damekjan/.m2/repository/ai/djl/huggingface/tokenizers/0.33.0/tokenizers-0.33.0.jar!/native/lib/tokenizers.properties
2025-06-20 08:54:04 [main] INFO  c.j.module.indexer.EmbeddingService - Loading text embedding model: intfloat/multilingual-e5-large
2025-06-20 08:54:05 [main] INFO  c.j.module.indexer.EmbeddingService - Embedding models initialized successfully
2025-06-20 08:54:05 [main] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - Initializing HuggingFace tokenizer with model: gpt2
2025-06-20 08:54:05 [main] WARN  a.d.h.t.HuggingFaceTokenizer - maxLength is not explicitly specified, use modelMaxLength: 512
2025-06-20 08:54:05 [main] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - HuggingFace tokenizer initialized successfully
2025-06-20 08:54:06 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-20 08:54:06 [main] INFO  o.s.v.b.OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
2025-06-20 08:54:06 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 5500 (http) with context path '/'
2025-06-20 08:54:06 [main] INFO  com.jervis.JervisApplicationKt - Started JervisApplicationKt in 8.541 seconds (process running for 9.076)
2025-06-20 08:54:07 [main] INFO  com.jervis.utils.MacOSAppUtils - Ikona v docku byla úspěšně nastavena pomocí Taskbar API
2025-06-20 08:54:20 [Thread-2] INFO  com.jervis.service.ChatService - Processing chat query: Ahoj, uz mame neco v pameti?
2025-06-20 08:54:20 [Thread-2] INFO  com.jervis.service.RagQueryService - Processing RAG query: Ahoj, uz mame neco v pameti?
2025-06-20 08:54:20 [Thread-2] DEBUG com.jervis.service.RagQueryService - Phase 1: Initial RAG query
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1}
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in unified collection: unified_vectors
2025-06-20 08:54:20 [Thread-2] ERROR c.j.module.vectordb.VectorDbService - Error searching for similar documents: class java.lang.Long cannot be cast to class java.lang.Integer (java.lang.Long and java.lang.Integer are in module java.base of loader 'bootstrap')
java.lang.ClassCastException: class java.lang.Long cannot be cast to class java.lang.Integer (java.lang.Long and java.lang.Integer are in module java.base of loader 'bootstrap')
	at com.jervis.module.vectordb.VectorDbService.searchSimilar(VectorDbService.kt:220)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:34)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1, source=memory, memory_type=DECISION}
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in unified collection: unified_vectors
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Applied filter to search
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Executing search in collection: unified_vectors
2025-06-20 08:54:20 [Thread-2] WARN  c.j.module.vectordb.VectorDbService - Error searching collection unified_vectors: Vector must not be empty
java.lang.IllegalArgumentException: Vector must not be empty
	at com.google.common.base.Preconditions.checkArgument(Preconditions.java:143)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2254)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2240)
	at com.jervis.module.vectordb.VectorDbService.searchSimilar(VectorDbService.kt:317)
	at com.jervis.module.memory.MemoryService.getMemoryItemsByType(MemoryService.kt:57)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.jervis.module.memory.MemoryService$$SpringCGLIB$$0.getMemoryItemsByType(<generated>)
	at com.jervis.module.ragcore.RagContextManager.addMemoryItemsToContext(RagContextManager.kt:92)
	at com.jervis.module.ragcore.RagContextManager.buildContext(RagContextManager.kt:40)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:41)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 total results across all collections
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Returning 0 results after sorting and limiting
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1, source=memory, memory_type=PLAN}
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in unified collection: unified_vectors
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Applied filter to search
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Executing search in collection: unified_vectors
2025-06-20 08:54:20 [Thread-2] WARN  c.j.module.vectordb.VectorDbService - Error searching collection unified_vectors: Vector must not be empty
java.lang.IllegalArgumentException: Vector must not be empty
	at com.google.common.base.Preconditions.checkArgument(Preconditions.java:143)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2254)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2240)
	at com.jervis.module.vectordb.VectorDbService.searchSimilar(VectorDbService.kt:317)
	at com.jervis.module.memory.MemoryService.getMemoryItemsByType(MemoryService.kt:57)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.jervis.module.memory.MemoryService$$SpringCGLIB$$0.getMemoryItemsByType(<generated>)
	at com.jervis.module.ragcore.RagContextManager.addMemoryItemsToContext(RagContextManager.kt:96)
	at com.jervis.module.ragcore.RagContextManager.buildContext(RagContextManager.kt:40)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:41)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 total results across all collections
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Returning 0 results after sorting and limiting
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1, source=memory, memory_type=MEETING_TRANSCRIPT}
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in unified collection: unified_vectors
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Applied filter to search
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Executing search in collection: unified_vectors
2025-06-20 08:54:20 [Thread-2] WARN  c.j.module.vectordb.VectorDbService - Error searching collection unified_vectors: Vector must not be empty
java.lang.IllegalArgumentException: Vector must not be empty
	at com.google.common.base.Preconditions.checkArgument(Preconditions.java:143)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2254)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2240)
	at com.jervis.module.vectordb.VectorDbService.searchSimilar(VectorDbService.kt:317)
	at com.jervis.module.memory.MemoryService.getMemoryItemsByType(MemoryService.kt:57)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.jervis.module.memory.MemoryService$$SpringCGLIB$$0.getMemoryItemsByType(<generated>)
	at com.jervis.module.ragcore.RagContextManager.addMemoryItemsToContext(RagContextManager.kt:101)
	at com.jervis.module.ragcore.RagContextManager.buildContext(RagContextManager.kt:40)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:41)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 total results across all collections
2025-06-20 08:54:20 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Returning 0 results after sorting and limiting
2025-06-20 08:54:21 [Thread-2] ERROR com.jervis.service.ChatService - Error processing chat query: 401 Unauthorized on POST request for "https://api.anthropic.com/v1/messages": [no body]
org.springframework.web.client.HttpClientErrorException$Unauthorized: 401 Unauthorized on POST request for "https://api.anthropic.com/v1/messages": [no body]
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:106)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:186)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147)
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801)
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518)
	at com.jervis.module.llmcoordinator.LlmCoordinator.callAnthropicApi(LlmCoordinator.kt:379)
	at com.jervis.module.llmcoordinator.LlmCoordinator.processAnthropicQuery(LlmCoordinator.kt:263)
	at com.jervis.module.llmcoordinator.LlmCoordinator.processQuery(LlmCoordinator.kt:203)
	at com.jervis.module.llmcoordinator.LlmCoordinator.processQuery$default(LlmCoordinator.kt:166)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:55)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 08:55:59 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-20 08:55:59 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-06-20 08:55:59 [SpringApplicationShutdownHook] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - Closing HuggingFace tokenizer
2025-06-20 08:55:59 [SpringApplicationShutdownHook] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - HuggingFace tokenizer closed successfully
2025-06-20 08:55:59 [SpringApplicationShutdownHook] INFO  c.j.module.indexer.EmbeddingService - Closing embedding models...
2025-06-20 08:55:59 [SpringApplicationShutdownHook] INFO  c.j.module.indexer.EmbeddingService - Embedding models closed successfully
2025-06-20 08:55:59 [SpringApplicationShutdownHook] INFO  c.j.module.vectordb.VectorDbService - Closing Qdrant client
2025-06-20 08:55:59 [SpringApplicationShutdownHook] INFO  c.j.module.vectordb.VectorDbService - Qdrant client closed successfully
2025-06-20 08:55:59 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-20 08:55:59 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-06-20 08:56:00 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-06-20 09:00:39 [main] INFO  com.jervis.JervisApplicationKt - Starting JervisApplicationKt using Java 21.0.7 with PID 90899 (/Users/damekjan/git/jervis/target/classes started by damekjan in /Users/damekjan/git/jervis)
2025-06-20 09:00:39 [main] DEBUG com.jervis.JervisApplicationKt - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-06-20 09:00:39 [main] INFO  com.jervis.JervisApplicationKt - No active profile set, falling back to 1 default profile: "default"
2025-06-20 09:00:40 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-20 09:00:40 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 24 ms. Found 2 JPA repository interfaces.
2025-06-20 09:00:40 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 5500 (http)
2025-06-20 09:00:40 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-20 09:00:40 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-06-20 09:00:40 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-20 09:00:40 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 868 ms
2025-06-20 09:00:40 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-20 09:00:40 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:file:~/.jervis/jervis-db user=SA
2025-06-20 09:00:40 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-20 09:00:40 [main] INFO  liquibase.database - Set default schema name to PUBLIC
2025-06-20 09:00:41 [main] INFO  liquibase.changelog - Reading from PUBLIC.DATABASECHANGELOG
2025-06-20 09:00:41 [main] INFO  liquibase.ui - Database is up to date, no changesets to execute
2025-06-20 09:00:41 [main] INFO  liquibase.changelog - Reading from PUBLIC.DATABASECHANGELOG
2025-06-20 09:00:41 [main] INFO  liquibase.util - UPDATE SUMMARY
2025-06-20 09:00:41 [main] INFO  liquibase.util - Run:                          0
2025-06-20 09:00:41 [main] INFO  liquibase.util - Previously run:               3
2025-06-20 09:00:41 [main] INFO  liquibase.util - Filtered out:                 0
2025-06-20 09:00:41 [main] INFO  liquibase.util - -------------------------------
2025-06-20 09:00:41 [main] INFO  liquibase.util - Total change sets:            3
2025-06-20 09:00:41 [main] INFO  liquibase.util - Update summary generated
2025-06-20 09:00:41 [main] INFO  liquibase.lockservice - Successfully released change log lock
2025-06-20 09:00:41 [main] INFO  liquibase.command - Command execution complete
2025-06-20 09:00:41 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-20 09:00:41 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.13.Final
2025-06-20 09:00:41 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-20 09:00:41 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-20 09:00:41 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-20 09:00:41 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.2.224
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-20 09:00:41 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-20 09:00:41 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-20 09:00:42 [main] INFO  c.j.module.vectordb.VectorDbService - Initializing Qdrant client at localhost:6334
2025-06-20 09:00:42 [main] INFO  c.j.module.vectordb.VectorDbService - Collection code_vectors already exists
2025-06-20 09:00:42 [main] INFO  c.j.module.vectordb.VectorDbService - Collection text_vectors already exists
2025-06-20 09:00:42 [main] INFO  c.j.module.vectordb.VectorDbService - Collection unified_vectors already exists
2025-06-20 09:00:42 [main] INFO  c.j.module.vectordb.VectorDbService - Qdrant client initialized successfully
2025-06-20 09:00:42 [main] INFO  c.j.module.indexer.EmbeddingService - Initializing embedding models...
2025-06-20 09:00:42 [main] INFO  c.j.module.indexer.EmbeddingService - Loading code embedding model: intfloat/multilingual-e5-large
2025-06-20 09:00:47 [main] INFO  ai.djl.pytorch.engine.PtEngine - PyTorch graph executor optimizer is enabled, this may impact your inference latency and throughput. See: https://docs.djl.ai/master/docs/development/inference_performance_optimization.html#graph-executor-optimization
2025-06-20 09:00:47 [main] INFO  ai.djl.pytorch.engine.PtEngine - Number of inter-op threads is 8
2025-06-20 09:00:47 [main] INFO  ai.djl.pytorch.engine.PtEngine - Number of intra-op threads is 6
2025-06-20 09:00:49 [main] INFO  ai.djl.util.Platform - Found matching platform from: jar:file:/Users/damekjan/.m2/repository/ai/djl/huggingface/tokenizers/0.33.0/tokenizers-0.33.0.jar!/native/lib/tokenizers.properties
2025-06-20 09:00:49 [main] INFO  c.j.module.indexer.EmbeddingService - Loading text embedding model: intfloat/multilingual-e5-large
2025-06-20 09:00:51 [main] INFO  c.j.module.indexer.EmbeddingService - Embedding models initialized successfully
2025-06-20 09:00:51 [main] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - Initializing HuggingFace tokenizer with model: gpt2
2025-06-20 09:00:51 [main] WARN  a.d.h.t.HuggingFaceTokenizer - maxLength is not explicitly specified, use modelMaxLength: 512
2025-06-20 09:00:51 [main] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - HuggingFace tokenizer initialized successfully
2025-06-20 09:00:51 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-20 09:00:51 [main] INFO  o.s.v.b.OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
2025-06-20 09:00:52 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 5500 (http) with context path '/'
2025-06-20 09:00:52 [main] INFO  com.jervis.JervisApplicationKt - Started JervisApplicationKt in 12.804 seconds (process running for 13.399)
2025-06-20 09:00:53 [main] INFO  com.jervis.utils.MacOSAppUtils - Ikona v docku byla úspěšně nastavena pomocí Taskbar API
2025-06-20 09:01:01 [Thread-2] INFO  com.jervis.service.ChatService - Processing chat query: Ahoj, mame neco v pameti
2025-06-20 09:01:01 [Thread-2] INFO  com.jervis.service.RagQueryService - Processing RAG query: Ahoj, mame neco v pameti
2025-06-20 09:01:01 [Thread-2] DEBUG com.jervis.service.RagQueryService - Phase 1: Initial RAG query
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1}
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in unified collection: unified_vectors
2025-06-20 09:01:02 [Thread-2] ERROR c.j.module.vectordb.VectorDbService - Error searching for similar documents: class java.lang.Long cannot be cast to class java.lang.Integer (java.lang.Long and java.lang.Integer are in module java.base of loader 'bootstrap')
java.lang.ClassCastException: class java.lang.Long cannot be cast to class java.lang.Integer (java.lang.Long and java.lang.Integer are in module java.base of loader 'bootstrap')
	at com.jervis.module.vectordb.VectorDbService.searchSimilar(VectorDbService.kt:220)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:34)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1, source=memory, memory_type=DECISION}
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in unified collection: unified_vectors
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Applied filter to search
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Executing search in collection: unified_vectors
2025-06-20 09:01:02 [Thread-2] WARN  c.j.module.vectordb.VectorDbService - Error searching collection unified_vectors: Vector must not be empty
java.lang.IllegalArgumentException: Vector must not be empty
	at com.google.common.base.Preconditions.checkArgument(Preconditions.java:143)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2254)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2240)
	at com.jervis.module.vectordb.VectorDbService.searchSimilar(VectorDbService.kt:317)
	at com.jervis.module.memory.MemoryService.getMemoryItemsByType(MemoryService.kt:57)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.jervis.module.memory.MemoryService$$SpringCGLIB$$0.getMemoryItemsByType(<generated>)
	at com.jervis.module.ragcore.RagContextManager.addMemoryItemsToContext(RagContextManager.kt:92)
	at com.jervis.module.ragcore.RagContextManager.buildContext(RagContextManager.kt:40)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:41)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 total results across all collections
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Returning 0 results after sorting and limiting
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1, source=memory, memory_type=PLAN}
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in unified collection: unified_vectors
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Applied filter to search
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Executing search in collection: unified_vectors
2025-06-20 09:01:02 [Thread-2] WARN  c.j.module.vectordb.VectorDbService - Error searching collection unified_vectors: Vector must not be empty
java.lang.IllegalArgumentException: Vector must not be empty
	at com.google.common.base.Preconditions.checkArgument(Preconditions.java:143)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2254)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2240)
	at com.jervis.module.vectordb.VectorDbService.searchSimilar(VectorDbService.kt:317)
	at com.jervis.module.memory.MemoryService.getMemoryItemsByType(MemoryService.kt:57)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.jervis.module.memory.MemoryService$$SpringCGLIB$$0.getMemoryItemsByType(<generated>)
	at com.jervis.module.ragcore.RagContextManager.addMemoryItemsToContext(RagContextManager.kt:96)
	at com.jervis.module.ragcore.RagContextManager.buildContext(RagContextManager.kt:40)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:41)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 total results across all collections
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Returning 0 results after sorting and limiting
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1, source=memory, memory_type=MEETING_TRANSCRIPT}
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in unified collection: unified_vectors
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Applied filter to search
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Executing search in collection: unified_vectors
2025-06-20 09:01:02 [Thread-2] WARN  c.j.module.vectordb.VectorDbService - Error searching collection unified_vectors: Vector must not be empty
java.lang.IllegalArgumentException: Vector must not be empty
	at com.google.common.base.Preconditions.checkArgument(Preconditions.java:143)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2254)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2240)
	at com.jervis.module.vectordb.VectorDbService.searchSimilar(VectorDbService.kt:317)
	at com.jervis.module.memory.MemoryService.getMemoryItemsByType(MemoryService.kt:57)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.jervis.module.memory.MemoryService$$SpringCGLIB$$0.getMemoryItemsByType(<generated>)
	at com.jervis.module.ragcore.RagContextManager.addMemoryItemsToContext(RagContextManager.kt:101)
	at com.jervis.module.ragcore.RagContextManager.buildContext(RagContextManager.kt:40)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:41)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 total results across all collections
2025-06-20 09:01:02 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Returning 0 results after sorting and limiting
2025-06-20 09:01:04 [Thread-2] ERROR com.jervis.service.ChatService - Error processing chat query: 401 Unauthorized on POST request for "https://api.anthropic.com/v1/messages": [no body]
org.springframework.web.client.HttpClientErrorException$Unauthorized: 401 Unauthorized on POST request for "https://api.anthropic.com/v1/messages": [no body]
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:106)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:186)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147)
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801)
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518)
	at com.jervis.module.llmcoordinator.LlmCoordinator.callAnthropicApi(LlmCoordinator.kt:380)
	at com.jervis.module.llmcoordinator.LlmCoordinator.processAnthropicQuery(LlmCoordinator.kt:263)
	at com.jervis.module.llmcoordinator.LlmCoordinator.processQuery(LlmCoordinator.kt:203)
	at com.jervis.module.llmcoordinator.LlmCoordinator.processQuery$default(LlmCoordinator.kt:166)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:55)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 09:04:18 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-20 09:04:18 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-06-20 09:04:18 [SpringApplicationShutdownHook] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - Closing HuggingFace tokenizer
2025-06-20 09:04:18 [SpringApplicationShutdownHook] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - HuggingFace tokenizer closed successfully
2025-06-20 09:04:18 [SpringApplicationShutdownHook] INFO  c.j.module.indexer.EmbeddingService - Closing embedding models...
2025-06-20 09:04:19 [SpringApplicationShutdownHook] INFO  c.j.module.indexer.EmbeddingService - Embedding models closed successfully
2025-06-20 09:04:19 [SpringApplicationShutdownHook] INFO  c.j.module.vectordb.VectorDbService - Closing Qdrant client
2025-06-20 09:04:19 [SpringApplicationShutdownHook] INFO  c.j.module.vectordb.VectorDbService - Qdrant client closed successfully
2025-06-20 09:04:19 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-20 09:04:19 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-06-20 09:04:19 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-06-20 13:40:31 [main] INFO  com.jervis.JervisApplicationKt - Starting JervisApplicationKt using Java 21.0.7 with PID 6207 (/Users/damekjan/git/jervis/target/classes started by damekjan in /Users/damekjan/git/jervis)
2025-06-20 13:40:31 [main] DEBUG com.jervis.JervisApplicationKt - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-06-20 13:40:31 [main] INFO  com.jervis.JervisApplicationKt - No active profile set, falling back to 1 default profile: "default"
2025-06-20 13:40:31 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-20 13:40:32 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 51 ms. Found 2 JPA repository interfaces.
2025-06-20 13:40:32 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 5500 (http)
2025-06-20 13:40:32 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-20 13:40:32 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-06-20 13:40:32 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-20 13:40:32 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1242 ms
2025-06-20 13:40:32 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-20 13:40:32 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:file:~/.jervis/jervis-db user=SA
2025-06-20 13:40:32 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-20 13:40:33 [main] INFO  liquibase.database - Set default schema name to PUBLIC
2025-06-20 13:40:33 [main] INFO  liquibase.changelog - Reading from PUBLIC.DATABASECHANGELOG
2025-06-20 13:40:33 [main] INFO  liquibase.ui - Database is up to date, no changesets to execute
2025-06-20 13:40:33 [main] INFO  liquibase.changelog - Reading from PUBLIC.DATABASECHANGELOG
2025-06-20 13:40:33 [main] INFO  liquibase.util - UPDATE SUMMARY
2025-06-20 13:40:33 [main] INFO  liquibase.util - Run:                          0
2025-06-20 13:40:33 [main] INFO  liquibase.util - Previously run:               3
2025-06-20 13:40:33 [main] INFO  liquibase.util - Filtered out:                 0
2025-06-20 13:40:33 [main] INFO  liquibase.util - -------------------------------
2025-06-20 13:40:33 [main] INFO  liquibase.util - Total change sets:            3
2025-06-20 13:40:33 [main] INFO  liquibase.util - Update summary generated
2025-06-20 13:40:33 [main] INFO  liquibase.lockservice - Successfully released change log lock
2025-06-20 13:40:33 [main] INFO  liquibase.command - Command execution complete
2025-06-20 13:40:33 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-20 13:40:33 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.13.Final
2025-06-20 13:40:33 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-20 13:40:33 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-20 13:40:33 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-20 13:40:33 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.2.224
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-20 13:40:34 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-20 13:40:34 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-20 13:40:34 [main] INFO  c.j.module.vectordb.VectorDbService - Initializing Qdrant client at localhost:6334
2025-06-20 13:40:34 [main] INFO  c.j.module.vectordb.VectorDbService - Collection unified_vectors already exists
2025-06-20 13:40:34 [main] INFO  c.j.module.vectordb.VectorDbService - Qdrant client initialized successfully
2025-06-20 13:40:34 [main] INFO  c.j.module.indexer.EmbeddingService - Initializing embedding models...
2025-06-20 13:40:34 [main] INFO  c.j.module.indexer.EmbeddingService - Loading code embedding model: intfloat/multilingual-e5-large
2025-06-20 13:40:35 [main] INFO  ai.djl.pytorch.engine.PtEngine - PyTorch graph executor optimizer is enabled, this may impact your inference latency and throughput. See: https://docs.djl.ai/master/docs/development/inference_performance_optimization.html#graph-executor-optimization
2025-06-20 13:40:35 [main] INFO  ai.djl.pytorch.engine.PtEngine - Number of inter-op threads is 8
2025-06-20 13:40:35 [main] INFO  ai.djl.pytorch.engine.PtEngine - Number of intra-op threads is 6
2025-06-20 13:40:36 [main] INFO  ai.djl.util.Platform - Found matching platform from: jar:file:/Users/damekjan/.m2/repository/ai/djl/huggingface/tokenizers/0.33.0/tokenizers-0.33.0.jar!/native/lib/tokenizers.properties
2025-06-20 13:40:37 [main] INFO  c.j.module.indexer.EmbeddingService - Loading text embedding model: intfloat/multilingual-e5-large
2025-06-20 13:40:38 [main] INFO  c.j.module.indexer.EmbeddingService - Embedding models initialized successfully
2025-06-20 13:40:38 [main] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - Initializing HuggingFace tokenizer with model: gpt2
2025-06-20 13:40:39 [main] WARN  a.d.h.t.HuggingFaceTokenizer - maxLength is not explicitly specified, use modelMaxLength: 512
2025-06-20 13:40:39 [main] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - HuggingFace tokenizer initialized successfully
2025-06-20 13:40:40 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-20 13:40:40 [main] INFO  o.s.v.b.OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
2025-06-20 13:40:40 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 5500 (http) with context path '/'
2025-06-20 13:40:40 [main] INFO  com.jervis.JervisApplicationKt - Started JervisApplicationKt in 9.24 seconds (process running for 10.416)
2025-06-20 13:40:41 [main] INFO  com.jervis.utils.MacOSAppUtils - Ikona v docku byla úspěšně nastavena pomocí Taskbar API
2025-06-20 13:40:51 [Thread-2] INFO  com.jervis.service.ChatService - Processing chat query: Test LLM spojeni
2025-06-20 13:40:51 [Thread-2] INFO  com.jervis.service.RagQueryService - Processing RAG query: Test LLM spojeni
2025-06-20 13:40:51 [Thread-2] DEBUG com.jervis.service.RagQueryService - Phase 1: Initial RAG query
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1}
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:40:52 [Thread-2] ERROR c.j.module.vectordb.VectorDbService - Error searching for similar documents: class java.lang.Long cannot be cast to class java.lang.Integer (java.lang.Long and java.lang.Integer are in module java.base of loader 'bootstrap')
java.lang.ClassCastException: class java.lang.Long cannot be cast to class java.lang.Integer (java.lang.Long and java.lang.Integer are in module java.base of loader 'bootstrap')
	at com.jervis.module.vectordb.VectorDbService.searchSimilar(VectorDbService.kt:214)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:34)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1, source=memory, memory_type=DECISION}
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Applied filter to search
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Executing search in collection: unified_vectors
2025-06-20 13:40:52 [Thread-2] WARN  c.j.module.vectordb.VectorDbService - Error searching collection unified_vectors: Vector must not be empty
java.lang.IllegalArgumentException: Vector must not be empty
	at com.google.common.base.Preconditions.checkArgument(Preconditions.java:143)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2254)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2240)
	at com.jervis.module.vectordb.VectorDbService.searchSimilar(VectorDbService.kt:311)
	at com.jervis.module.memory.MemoryService.getMemoryItemsByType(MemoryService.kt:57)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.jervis.module.memory.MemoryService$$SpringCGLIB$$0.getMemoryItemsByType(<generated>)
	at com.jervis.module.ragcore.RagContextManager.addMemoryItemsToContext(RagContextManager.kt:92)
	at com.jervis.module.ragcore.RagContextManager.buildContext(RagContextManager.kt:40)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:41)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 total results across all collections
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Returning 0 results after sorting and limiting
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1, source=memory, memory_type=PLAN}
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Applied filter to search
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Executing search in collection: unified_vectors
2025-06-20 13:40:52 [Thread-2] WARN  c.j.module.vectordb.VectorDbService - Error searching collection unified_vectors: Vector must not be empty
java.lang.IllegalArgumentException: Vector must not be empty
	at com.google.common.base.Preconditions.checkArgument(Preconditions.java:143)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2254)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2240)
	at com.jervis.module.vectordb.VectorDbService.searchSimilar(VectorDbService.kt:311)
	at com.jervis.module.memory.MemoryService.getMemoryItemsByType(MemoryService.kt:57)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.jervis.module.memory.MemoryService$$SpringCGLIB$$0.getMemoryItemsByType(<generated>)
	at com.jervis.module.ragcore.RagContextManager.addMemoryItemsToContext(RagContextManager.kt:96)
	at com.jervis.module.ragcore.RagContextManager.buildContext(RagContextManager.kt:40)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:41)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 total results across all collections
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Returning 0 results after sorting and limiting
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1, source=memory, memory_type=MEETING_TRANSCRIPT}
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Applied filter to search
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Executing search in collection: unified_vectors
2025-06-20 13:40:52 [Thread-2] WARN  c.j.module.vectordb.VectorDbService - Error searching collection unified_vectors: Vector must not be empty
java.lang.IllegalArgumentException: Vector must not be empty
	at com.google.common.base.Preconditions.checkArgument(Preconditions.java:143)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2254)
	at io.qdrant.client.QdrantClient.searchAsync(QdrantClient.java:2240)
	at com.jervis.module.vectordb.VectorDbService.searchSimilar(VectorDbService.kt:311)
	at com.jervis.module.memory.MemoryService.getMemoryItemsByType(MemoryService.kt:57)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:724)
	at com.jervis.module.memory.MemoryService$$SpringCGLIB$$0.getMemoryItemsByType(<generated>)
	at com.jervis.module.ragcore.RagContextManager.addMemoryItemsToContext(RagContextManager.kt:101)
	at com.jervis.module.ragcore.RagContextManager.buildContext(RagContextManager.kt:40)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:41)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 total results across all collections
2025-06-20 13:40:52 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Returning 0 results after sorting and limiting
2025-06-20 13:40:53 [Thread-2] ERROR com.jervis.service.ChatService - Error processing chat query: 401 Unauthorized on POST request for "https://api.anthropic.com/v1/messages": [no body]
org.springframework.web.client.HttpClientErrorException$Unauthorized: 401 Unauthorized on POST request for "https://api.anthropic.com/v1/messages": [no body]
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:106)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:186)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147)
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801)
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518)
	at com.jervis.module.llmcoordinator.LlmCoordinator.callAnthropicApi(LlmCoordinator.kt:408)
	at com.jervis.module.llmcoordinator.LlmCoordinator.processAnthropicQuery(LlmCoordinator.kt:286)
	at com.jervis.module.llmcoordinator.LlmCoordinator.processQuery(LlmCoordinator.kt:219)
	at com.jervis.module.llmcoordinator.LlmCoordinator.processQuery$default(LlmCoordinator.kt:174)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:55)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 13:48:14 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-20 13:48:14 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-06-20 13:48:14 [SpringApplicationShutdownHook] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - Closing HuggingFace tokenizer
2025-06-20 13:48:14 [SpringApplicationShutdownHook] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - HuggingFace tokenizer closed successfully
2025-06-20 13:48:14 [SpringApplicationShutdownHook] INFO  c.j.module.indexer.EmbeddingService - Closing embedding models...
2025-06-20 13:48:15 [SpringApplicationShutdownHook] INFO  c.j.module.indexer.EmbeddingService - Embedding models closed successfully
2025-06-20 13:48:15 [SpringApplicationShutdownHook] INFO  c.j.module.vectordb.VectorDbService - Closing Qdrant client
2025-06-20 13:48:15 [SpringApplicationShutdownHook] INFO  c.j.module.vectordb.VectorDbService - Qdrant client closed successfully
2025-06-20 13:48:15 [SpringApplicationShutdownHook] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Closing JPA EntityManagerFactory for persistence unit 'default'
2025-06-20 13:48:15 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2025-06-20 13:48:15 [SpringApplicationShutdownHook] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
2025-06-20 13:48:21 [main] INFO  com.jervis.JervisApplicationKt - Starting JervisApplicationKt using Java 21.0.7 with PID 7025 (/Users/damekjan/git/jervis/target/classes started by damekjan in /Users/damekjan/git/jervis)
2025-06-20 13:48:21 [main] DEBUG com.jervis.JervisApplicationKt - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-06-20 13:48:21 [main] INFO  com.jervis.JervisApplicationKt - No active profile set, falling back to 1 default profile: "default"
2025-06-20 13:48:21 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-20 13:48:21 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 22 ms. Found 2 JPA repository interfaces.
2025-06-20 13:48:22 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 5500 (http)
2025-06-20 13:48:22 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-20 13:48:22 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-06-20 13:48:22 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-20 13:48:22 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 918 ms
2025-06-20 13:48:22 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-20 13:48:22 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:file:~/.jervis/jervis-db user=SA
2025-06-20 13:48:22 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-20 13:48:22 [main] INFO  liquibase.database - Set default schema name to PUBLIC
2025-06-20 13:48:22 [main] INFO  liquibase.changelog - Reading from PUBLIC.DATABASECHANGELOG
2025-06-20 13:48:22 [main] INFO  liquibase.ui - Database is up to date, no changesets to execute
2025-06-20 13:48:22 [main] INFO  liquibase.changelog - Reading from PUBLIC.DATABASECHANGELOG
2025-06-20 13:48:22 [main] INFO  liquibase.util - UPDATE SUMMARY
2025-06-20 13:48:22 [main] INFO  liquibase.util - Run:                          0
2025-06-20 13:48:22 [main] INFO  liquibase.util - Previously run:               3
2025-06-20 13:48:22 [main] INFO  liquibase.util - Filtered out:                 0
2025-06-20 13:48:22 [main] INFO  liquibase.util - -------------------------------
2025-06-20 13:48:22 [main] INFO  liquibase.util - Total change sets:            3
2025-06-20 13:48:22 [main] INFO  liquibase.util - Update summary generated
2025-06-20 13:48:22 [main] INFO  liquibase.lockservice - Successfully released change log lock
2025-06-20 13:48:22 [main] INFO  liquibase.command - Command execution complete
2025-06-20 13:48:22 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-20 13:48:22 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.13.Final
2025-06-20 13:48:22 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-20 13:48:23 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-20 13:48:23 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-20 13:48:23 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.2.224
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-20 13:48:23 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-20 13:48:23 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-20 13:48:23 [main] INFO  c.j.module.vectordb.VectorDbService - Initializing Qdrant client at localhost:6334
2025-06-20 13:48:24 [main] INFO  c.j.module.vectordb.VectorDbService - Collection unified_vectors already exists
2025-06-20 13:48:24 [main] INFO  c.j.module.vectordb.VectorDbService - Qdrant client initialized successfully
2025-06-20 13:48:24 [main] INFO  c.j.module.indexer.EmbeddingService - Initializing embedding models...
2025-06-20 13:48:24 [main] INFO  c.j.module.indexer.EmbeddingService - Loading code embedding model: intfloat/multilingual-e5-large
2025-06-20 13:48:28 [main] INFO  ai.djl.pytorch.engine.PtEngine - PyTorch graph executor optimizer is enabled, this may impact your inference latency and throughput. See: https://docs.djl.ai/master/docs/development/inference_performance_optimization.html#graph-executor-optimization
2025-06-20 13:48:28 [main] INFO  ai.djl.pytorch.engine.PtEngine - Number of inter-op threads is 8
2025-06-20 13:48:28 [main] INFO  ai.djl.pytorch.engine.PtEngine - Number of intra-op threads is 6
2025-06-20 13:48:29 [main] INFO  ai.djl.util.Platform - Found matching platform from: jar:file:/Users/damekjan/.m2/repository/ai/djl/huggingface/tokenizers/0.33.0/tokenizers-0.33.0.jar!/native/lib/tokenizers.properties
2025-06-20 13:48:30 [main] INFO  c.j.module.indexer.EmbeddingService - Loading text embedding model: intfloat/multilingual-e5-large
2025-06-20 13:48:32 [main] INFO  c.j.module.indexer.EmbeddingService - Embedding models initialized successfully
2025-06-20 13:48:32 [main] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - Initializing HuggingFace tokenizer with model: gpt2
2025-06-20 13:48:32 [main] WARN  a.d.h.t.HuggingFaceTokenizer - maxLength is not explicitly specified, use modelMaxLength: 512
2025-06-20 13:48:32 [main] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - HuggingFace tokenizer initialized successfully
2025-06-20 13:48:32 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-20 13:48:32 [main] INFO  o.s.v.b.OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
2025-06-20 13:48:33 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 5500 (http) with context path '/'
2025-06-20 13:48:33 [main] INFO  com.jervis.JervisApplicationKt - Started JervisApplicationKt in 12.299 seconds (process running for 13.087)
2025-06-20 13:48:34 [main] INFO  com.jervis.utils.MacOSAppUtils - Ikona v docku byla úspěšně nastavena pomocí Taskbar API
2025-06-20 13:48:42 [Thread-2] INFO  com.jervis.service.ChatService - Processing chat query: test hledani v pameti
2025-06-20 13:48:42 [Thread-2] INFO  com.jervis.service.RagQueryService - Processing RAG query: test hledani v pameti
2025-06-20 13:48:42 [Thread-2] DEBUG com.jervis.service.RagQueryService - Phase 1: Initial RAG query
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1}
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:48:43 [Thread-2] ERROR c.j.module.vectordb.VectorDbService - Error searching for similar documents: class java.lang.Long cannot be cast to class java.lang.Integer (java.lang.Long and java.lang.Integer are in module java.base of loader 'bootstrap')
java.lang.ClassCastException: class java.lang.Long cannot be cast to class java.lang.Integer (java.lang.Long and java.lang.Integer are in module java.base of loader 'bootstrap')
	at com.jervis.module.vectordb.VectorDbService.searchSimilar(VectorDbService.kt:222)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:34)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1, source=memory, memory_type=DECISION}
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Empty query vector provided, using default vector
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Applied filter to search
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Executing search in collection: unified_vectors
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 results in collection: unified_vectors
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 total results across all collections
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Returning 0 results after sorting and limiting
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1, source=memory, memory_type=PLAN}
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Empty query vector provided, using default vector
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Applied filter to search
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Executing search in collection: unified_vectors
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 results in collection: unified_vectors
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 total results across all collections
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Returning 0 results after sorting and limiting
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1, source=memory, memory_type=MEETING_TRANSCRIPT}
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Empty query vector provided, using default vector
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Applied filter to search
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Executing search in collection: unified_vectors
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 results in collection: unified_vectors
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 total results across all collections
2025-06-20 13:48:43 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Returning 0 results after sorting and limiting
2025-06-20 13:48:43 [Thread-2] ERROR com.jervis.service.ChatService - Error processing chat query: 401 Unauthorized on POST request for "https://api.anthropic.com/v1/messages": [no body]
org.springframework.web.client.HttpClientErrorException$Unauthorized: 401 Unauthorized on POST request for "https://api.anthropic.com/v1/messages": [no body]
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:106)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:186)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147)
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801)
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518)
	at com.jervis.module.llmcoordinator.LlmCoordinator.callAnthropicApi(LlmCoordinator.kt:408)
	at com.jervis.module.llmcoordinator.LlmCoordinator.processAnthropicQuery(LlmCoordinator.kt:286)
	at com.jervis.module.llmcoordinator.LlmCoordinator.processQuery(LlmCoordinator.kt:219)
	at com.jervis.module.llmcoordinator.LlmCoordinator.processQuery$default(LlmCoordinator.kt:174)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:55)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 13:50:33 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-06-20 13:50:33 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-06-20 13:50:33 [SpringApplicationShutdownHook] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - Closing HuggingFace tokenizer
2025-06-20 13:50:33 [SpringApplicationShutdownHook] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - HuggingFace tokenizer closed successfully
2025-06-20 13:50:33 [SpringApplicationShutdownHook] INFO  c.j.module.indexer.EmbeddingService - Closing embedding models...
2025-06-20 13:52:46 [main] INFO  com.jervis.JervisApplicationKt - Starting JervisApplicationKt using Java 21.0.7 with PID 7448 (/Users/damekjan/git/jervis/target/classes started by damekjan in /Users/damekjan/git/jervis)
2025-06-20 13:52:46 [main] DEBUG com.jervis.JervisApplicationKt - Running with Spring Boot v3.4.5, Spring v6.2.6
2025-06-20 13:52:46 [main] INFO  com.jervis.JervisApplicationKt - No active profile set, falling back to 1 default profile: "default"
2025-06-20 13:52:47 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2025-06-20 13:52:47 [main] INFO  o.s.d.r.c.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 28 ms. Found 2 JPA repository interfaces.
2025-06-20 13:52:47 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 5500 (http)
2025-06-20 13:52:47 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-06-20 13:52:47 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-06-20 13:52:47 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-06-20 13:52:47 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 983 ms
2025-06-20 13:52:47 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2025-06-20 13:52:48 [main] INFO  com.zaxxer.hikari.pool.HikariPool - HikariPool-1 - Added connection conn0: url=jdbc:h2:file:~/.jervis/jervis-db user=SA
2025-06-20 13:52:48 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
2025-06-20 13:52:48 [main] INFO  liquibase.database - Set default schema name to PUBLIC
2025-06-20 13:52:48 [main] INFO  liquibase.changelog - Reading from PUBLIC.DATABASECHANGELOG
2025-06-20 13:52:48 [main] INFO  liquibase.ui - Database is up to date, no changesets to execute
2025-06-20 13:52:48 [main] INFO  liquibase.changelog - Reading from PUBLIC.DATABASECHANGELOG
2025-06-20 13:52:48 [main] INFO  liquibase.util - UPDATE SUMMARY
2025-06-20 13:52:48 [main] INFO  liquibase.util - Run:                          0
2025-06-20 13:52:48 [main] INFO  liquibase.util - Previously run:               3
2025-06-20 13:52:48 [main] INFO  liquibase.util - Filtered out:                 0
2025-06-20 13:52:48 [main] INFO  liquibase.util - -------------------------------
2025-06-20 13:52:48 [main] INFO  liquibase.util - Total change sets:            3
2025-06-20 13:52:48 [main] INFO  liquibase.util - Update summary generated
2025-06-20 13:52:48 [main] INFO  liquibase.lockservice - Successfully released change log lock
2025-06-20 13:52:48 [main] INFO  liquibase.command - Command execution complete
2025-06-20 13:52:48 [main] INFO  o.h.jpa.internal.util.LogHelper - HHH000204: Processing PersistenceUnitInfo [name: default]
2025-06-20 13:52:48 [main] INFO  org.hibernate.Version - HHH000412: Hibernate ORM core version 6.6.13.Final
2025-06-20 13:52:48 [main] INFO  o.h.c.i.RegionFactoryInitiator - HHH000026: Second-level cache disabled
2025-06-20 13:52:48 [main] INFO  o.s.o.j.p.SpringPersistenceUnitInfo - No LoadTimeWeaver setup: ignoring JPA class transformer
2025-06-20 13:52:48 [main] WARN  org.hibernate.orm.deprecation - HHH90000025: H2Dialect does not need to be specified explicitly using 'hibernate.dialect' (remove the property setting and it will be selected by default)
2025-06-20 13:52:48 [main] INFO  o.hibernate.orm.connections.pooling - HHH10001005: Database info:
	Database JDBC URL [Connecting through datasource 'HikariDataSource (HikariPool-1)']
	Database driver: undefined/unknown
	Database version: 2.2.224
	Autocommit mode: undefined/unknown
	Isolation level: undefined/unknown
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2025-06-20 13:52:49 [main] INFO  o.h.e.t.j.p.i.JtaPlatformInitiator - HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2025-06-20 13:52:49 [main] INFO  o.s.o.j.LocalContainerEntityManagerFactoryBean - Initialized JPA EntityManagerFactory for persistence unit 'default'
2025-06-20 13:52:49 [main] INFO  c.j.module.vectordb.VectorDbService - Initializing Qdrant client at localhost:6334
2025-06-20 13:52:49 [main] INFO  c.j.module.vectordb.VectorDbService - Collection unified_vectors already exists
2025-06-20 13:52:49 [main] INFO  c.j.module.vectordb.VectorDbService - Qdrant client initialized successfully
2025-06-20 13:52:49 [main] INFO  c.j.module.indexer.EmbeddingService - Initializing embedding models...
2025-06-20 13:52:49 [main] INFO  c.j.module.indexer.EmbeddingService - Loading code embedding model: intfloat/multilingual-e5-large
2025-06-20 13:52:50 [main] INFO  ai.djl.pytorch.engine.PtEngine - PyTorch graph executor optimizer is enabled, this may impact your inference latency and throughput. See: https://docs.djl.ai/master/docs/development/inference_performance_optimization.html#graph-executor-optimization
2025-06-20 13:52:50 [main] INFO  ai.djl.pytorch.engine.PtEngine - Number of inter-op threads is 8
2025-06-20 13:52:50 [main] INFO  ai.djl.pytorch.engine.PtEngine - Number of intra-op threads is 6
2025-06-20 13:52:51 [main] INFO  ai.djl.util.Platform - Found matching platform from: jar:file:/Users/damekjan/.m2/repository/ai/djl/huggingface/tokenizers/0.33.0/tokenizers-0.33.0.jar!/native/lib/tokenizers.properties
2025-06-20 13:52:52 [main] INFO  c.j.module.indexer.EmbeddingService - Loading text embedding model: intfloat/multilingual-e5-large
2025-06-20 13:52:53 [main] INFO  c.j.module.indexer.EmbeddingService - Embedding models initialized successfully
2025-06-20 13:52:53 [main] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - Initializing HuggingFace tokenizer with model: gpt2
2025-06-20 13:52:54 [main] WARN  a.d.h.t.HuggingFaceTokenizer - maxLength is not explicitly specified, use modelMaxLength: 512
2025-06-20 13:52:54 [main] INFO  c.j.m.i.t.HuggingFaceTokenizerImpl - HuggingFace tokenizer initialized successfully
2025-06-20 13:52:54 [main] WARN  o.s.b.a.o.j.JpaBaseConfiguration$JpaWebConfiguration - spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2025-06-20 13:52:55 [main] INFO  o.s.v.b.OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
2025-06-20 13:52:55 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 5500 (http) with context path '/'
2025-06-20 13:52:55 [main] INFO  com.jervis.JervisApplicationKt - Started JervisApplicationKt in 8.781 seconds (process running for 9.336)
2025-06-20 13:52:56 [main] INFO  com.jervis.utils.MacOSAppUtils - Ikona v docku byla úspěšně nastavena pomocí Taskbar API
2025-06-20 13:53:02 [Thread-2] INFO  com.jervis.service.ChatService - Processing chat query: test llm
2025-06-20 13:53:02 [Thread-2] INFO  com.jervis.service.RagQueryService - Processing RAG query: test llm
2025-06-20 13:53:02 [Thread-2] DEBUG com.jervis.service.RagQueryService - Phase 1: Initial RAG query
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1}
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:53:03 [Thread-2] ERROR c.j.module.vectordb.VectorDbService - Error searching for similar documents: class java.lang.Long cannot be cast to class java.lang.Integer (java.lang.Long and java.lang.Integer are in module java.base of loader 'bootstrap')
java.lang.ClassCastException: class java.lang.Long cannot be cast to class java.lang.Integer (java.lang.Long and java.lang.Integer are in module java.base of loader 'bootstrap')
	at com.jervis.module.vectordb.VectorDbService.searchSimilar(VectorDbService.kt:222)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:34)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1, source=memory, memory_type=DECISION}
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Empty query vector provided, using default vector
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Applied filter to search
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Executing search in collection: unified_vectors
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 results in collection: unified_vectors
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 total results across all collections
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Returning 0 results after sorting and limiting
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1, source=memory, memory_type=PLAN}
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Empty query vector provided, using default vector
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Applied filter to search
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Executing search in collection: unified_vectors
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 results in collection: unified_vectors
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 total results across all collections
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Returning 0 results after sorting and limiting
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching for similar documents with filter: {project=1, source=memory, memory_type=MEETING_TRANSCRIPT}
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Empty query vector provided, using default vector
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Searching in collection: unified_vectors
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Applied filter to search
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Executing search in collection: unified_vectors
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 results in collection: unified_vectors
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Found 0 total results across all collections
2025-06-20 13:53:03 [Thread-2] DEBUG c.j.module.vectordb.VectorDbService - Returning 0 results after sorting and limiting
2025-06-20 13:53:03 [Thread-2] ERROR com.jervis.service.ChatService - Error processing chat query: 401 Unauthorized on POST request for "https://api.anthropic.com/v1/messages": [no body]
org.springframework.web.client.HttpClientErrorException$Unauthorized: 401 Unauthorized on POST request for "https://api.anthropic.com/v1/messages": [no body]
	at org.springframework.web.client.HttpClientErrorException.create(HttpClientErrorException.java:106)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:186)
	at org.springframework.web.client.DefaultResponseErrorHandler.handleError(DefaultResponseErrorHandler.java:147)
	at org.springframework.web.client.RestTemplate.handleResponse(RestTemplate.java:953)
	at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:902)
	at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:801)
	at org.springframework.web.client.RestTemplate.postForObject(RestTemplate.java:518)
	at com.jervis.module.llmcoordinator.LlmCoordinator.callAnthropicApi(LlmCoordinator.kt:408)
	at com.jervis.module.llmcoordinator.LlmCoordinator.processAnthropicQuery(LlmCoordinator.kt:286)
	at com.jervis.module.llmcoordinator.LlmCoordinator.processQuery(LlmCoordinator.kt:219)
	at com.jervis.module.llmcoordinator.LlmCoordinator.processQuery$default(LlmCoordinator.kt:174)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery(RagOrchestrator.kt:55)
	at com.jervis.module.ragcore.RagOrchestrator.processQuery$default(RagOrchestrator.kt:28)
	at com.jervis.service.RagQueryService.processRagQuery(RagQueryService.kt:42)
	at com.jervis.service.RagQueryService.processRagQuery$default(RagQueryService.kt:34)
	at com.jervis.service.ChatService.processQuery(ChatService.kt:26)
	at com.jervis.window.MainWindow.lambda$4$lambda$3(MainWindow.kt:62)
	at java.base/java.lang.Thread.run(Thread.java:1583)
