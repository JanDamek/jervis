apiVersion: v1
kind: ConfigMap
metadata:
  name: jervis-server-config
  namespace: jervis
data:
  # Logging configuration
  LOG_LEVEL_ROOT: "INFO"
  LOG_LEVEL_JERVIS: "INFO"
  LOG_LEVEL_KTOR: "INFO"
  LOG_LEVEL_SPRING: "INFO"
  LOG_LEVEL_KOOG: "INFO"

  # Server configuration
  SERVER_PORT: "5500"
  DATA_ROOT_DIR: "/opt/jervis/data"
  WORK_DATA: "/opt/jervis/work"

  # MongoDB configuration
  MONGODB_HOST: "192.168.100.117"
  MONGODB_PORT: "27017"
  MONGODB_DATABASE: "jervis"
  MONGODB_USERNAME: "root"
  MONGODB_AUTH_DATABASE: "admin"

  # Weaviate configuration
  WEAVIATE_HOST: "192.168.100.117"
  WEAVIATE_PORT: "8080"
  WEAVIATE_SCHEME: "http"
  WEAVIATE_GRPC_PORT: "50051"
  WEAVIATE_HYBRID_ALPHA: "0.85"
  WEAVIATE_AUTO_MIGRATE_COUNTDOWN: "10"

  # ArangoDB configuration
  ARANGO_SCHEME: "http"
  ARANGO_HOST: "192.168.100.117"
  ARANGO_PORT: "8529"
  ARANGO_DATABASE: "jervis"
  ARANGO_USERNAME: "root"
  ARANGO_TIMEOUT_MS: "5000"

  # Ktor client configuration
  KTOR_CONNECTION_POOL_MAX_CONNECTIONS: "500"
  KTOR_CONNECTION_POOL_MAX_CONNECTIONS_PER_ROUTE: "100"
  KTOR_CONNECTION_POOL_KEEP_ALIVE_TIME_MILLIS: "300000"
  KTOR_TIMEOUTS_CONNECT_TIMEOUT_MILLIS: "60000"
  KTOR_TIMEOUTS_REQUEST_TIMEOUT_MILLIS: "1800000"
  KTOR_TIMEOUTS_SOCKET_TIMEOUT_MILLIS: "1800000"
  KTOR_API_VERSIONS_ANTHROPIC_VERSION: "2023-06-01"
  KTOR_LOGGING_ENABLED: "false"
  KTOR_LOGGING_LEVEL: "INFO"

  # Retry configuration
  RETRY_MAX_ATTEMPTS: "5"
  RETRY_INITIAL_BACKOFF_MILLIS: "1000"
  RETRY_MAX_BACKOFF_MILLIS: "30000"

  # Jervis configuration
  JERVIS_CLIENT_TOKEN: "a7f3c9e2-4b8d-11ef-9a1c-0242ac120002"
  JERVIS_SSL_ENABLED: "false"
  JERVIS_KOOG_MAX_ITERATIONS: "50"
  JERVIS_KOOG_QUALIFIER_MAX_RETRIES: "5"
  JERVIS_BACKGROUND_WAIT_ON_STARTUP: "PT10S"
  JERVIS_BACKGROUND_WAIT_ON_ERROR: "PT1M"
  JERVIS_BACKGROUND_WAIT_INTERVAL: "PT30S"

  # Link indexing configuration
  LINK_INDEXING_SKIP_IF_INDEXED_WITHIN: "PT720H"

  # Ollama preload configuration
  OLLAMA_GPU_CONCURRENCY: "2"
  OLLAMA_CPU_CONCURRENCY: "6"
  OLLAMA_LLM_KEEP_ALIVE: "1h"
  OLLAMA_LLM_REFRESH_SAFETY_FACTOR: "0.9"
  OLLAMA_EMBED_CONCURRENCY: "6"
  OLLAMA_EMBED_KEEP_ALIVE: "1h"
  OLLAMA_EMBED_REFRESH_SAFETY_FACTOR: "0.9"

  # Coding tools configuration
  AIDER_DEFAULT_PROVIDER: "ollama"
  AIDER_DEFAULT_MODEL: "qwen3-coder-tool:30b"
  AIDER_PAID_PROVIDER: "anthropic"
  AIDER_PAID_MODEL: "claude-3-5-sonnet-20241022"
  OPENHANDS_DEFAULT_PROVIDER: "ollama"
  OPENHANDS_DEFAULT_MODEL: "qwen3-coder-tool:30b"
  OPENHANDS_PAID_PROVIDER: "anthropic"
  OPENHANDS_PAID_MODEL: "claude-3-5-sonnet-20241022"
  OPENHANDS_OLLAMA_BASE_URL: "http://192.168.100.117:11434"

  # Service endpoints
  SEARXNG_BASE_URL: "http://192.168.100.117:30053/"
  JOERN_BASE_URL: "http://jervis-joern:8080/"
  TIKA_BASE_URL: "http://jervis-tika:8080/"
  WHISPER_BASE_URL: "http://jervis-whisper:8080/"
  ATLASSIAN_BASE_URL: "http://jervis-atlassian:8080/"
  AIDER_BASE_URL: "http://jervis-aider:3100/"
  CODING_BASE_URL: "http://jervis-coding-engine:3200/"
  JUNIE_BASE_URL: "http://jervis-junie:3300/"
